{% load static %}
{% load custom_filters %}

{% for item in recipes_list %}
<div data-id="{{ item.id }}" class="recipe_item">
    <div class="recipe_item_header">
        <div class="image_wrapper">
            <a href="{% url 'recipes:detail' item.id item.slug %}">
                <img data-id="{{ item.id }}" class="back_image" src="{% if item.previews.preview_1 %}{{ item.previews.optimized_image_1_small.url }}{% else %}{% static 'img/Default/Default_image.jpg' %}{% endif %}">
            </a>
            {% if user.is_authenticated %}
                {% if item in user.liked_recipes.all %}
                <div class="heart_wrapper active" data-url="{% url 'recipes:recipe_like_ajax' %}" data-id="{{ item.id }}">
                    <img src="{% static 'svg/Random_icons/Heart_fill.svg' %}">
                </div>
                {% else %}
                <div class="heart_wrapper" data-url="{% url 'recipes:recipe_like_ajax' %}" data-id="{{ item.id }}">
                    <img src="{% static 'svg/Random_icons/Heart_blank.svg' %}">
                </div>
                {% endif %}
            {% else %}
            <div class="heart_wrapper" data-url="{% url 'recipes:recipe_like_ajax' %}" data-id="{{ item.id }}">
                <img src="{% static 'svg/Random_icons/Heart_blank.svg' %}">
            </div>
            {% endif %}
            <div class="buttons">
                {% if item.status != 1 %}
                <a href="{% url 'recipes:edit' item.id %}" class="change">
                    <img src="{% static 'svg/Random_icons/Edit_icon.svg' %}">
                    <h4>Редактировать</h4>
                </a>
                {% endif %}
                {% if item.status == 2 %}
                <div data-url="{% url 'recipes:change_status_ajax' %}" class="public">
                    <img src="{% static 'svg/Yes_No/Yes_no_shadow.svg' %}">
                    <h4 class="medium_font white">Опубликовать</h4>
                </div>
                {% elif item.status == 1 %}
                <div data-url="{% url 'recipes:change_status_ajax' %}" class="unpublic">
                    <img src="{% static 'svg/Yes_No/No_no_shadow.svg' %}">
                    <h4 class="medium_font white">Снять с публикации</h4>
                </div>
                {% elif item.status == 4 %}
                <div class="moderator">
                    <img src="{% static 'svg/Random_icons/Gear_icon_white.svg' %}">
                    <h4 class="medium_font white">Проверяется модератором</h4>
                </div>
                {% endif %}
            </div>
        </div>
        <div class="info">
            <div class="calories">
                <img src="{% static 'svg/Random_icons/Callories_icon.svg' %}">
                <h4>{{ item.calculate_calories_per_100g }} ккал</h4>
            </div>
            <div data-id="{{ item.id }}" class="time">
                <img src="{% static 'svg/Random_icons/Clock_icon.svg' %}">
                <h4>{{ item.cook_time_full|short_timedelta }}</h4>
            </div>
        </div>
        <a href="{% url 'recipes:detail' item.id item.slug %}">
            <h3 class="title medium_font">{{ item.title }}</h3>
        </a>
        <h4 class="description">{{ item.description_card }}</h4>
    </div>
    <div class="recipe_item_footer">
        <a href="{% url 'users:author' item.author.username %}" class="icon_title">
            <img src="{% static 'svg/Cookie/Smile_half_black.svg' %}">
            <h4>{% if item.author.name %}{{ item.author.name }}{% else %}{{ item.author.username }}{% endif %}</h4>
        </a>
        <a href="">
            <img class="share_button" src="{% static 'svg/Random_icons/Share_icon.svg' %}">
        </a>

        <div class="socials pop_up_share d_none" data-title="{{ item.title }}" data-url="{% url 'recipes:detail' item.id item.slug %}">
            <img class="share_option" data-social="tg" src="{% static 'svg/Socials_Colorful/TG.svg' %}">
            <img class="share_option" data-social="vk" src="{% static 'svg/Socials_Colorful/VK.svg' %}">
            <img class="share_option" data-social="ws" src="{% static 'svg/Socials_Colorful/WS.svg' %}">
            <img class="share_option" data-social="pinterest" src="{% static 'svg/Socials_Colorful/Pinterest.svg' %}">
            <div class="copy_wrapper">
                <img class="copy_option" data-social="copy" src="{% static 'svg/Socials_Colorful/Copy.svg' %}">
                <div class="copy_window">
                    <div class="inner_wrapper">
                        <h5>Ссылка скопирована!</h5>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div data-id="{{ item.id }}" class="pop_up_window cook_time_window d_none">
        <p>Время приготовления</p>
        <div class="inner_wrapper">
            <img src="{% static 'svg/Random_icons/Clock_icon.svg' %}">
            <h5 class="green">Общее - {{ item.cook_time_full|short_timedelta }}</h5>
        </div>
        <div class="inner_wrapper">
            <img src="{% static 'svg/Random_icons/Clock_icon_red.svg' %}">
            <h5 class="red">Активное - {{ item.cook_time_active|short_timedelta }}</h5>
        </div>
    </div>
    <div data-id="{{ item.id }}" class="pop_up_window ingredients_window d_none">
        <p>Ингредиенты</p>
        {% for ingredient in item.recipeingredient_set.all %}
        <div class="inner_wrapper">
            <h5>{{ ingredient.ingredient.title }} - {{ ingredient.quantity|round_ingredient_count }} {{ ingredient.unit }}</h5>
        </div>
        {% endfor %}
    </div>
</div>
{% endfor %}